<!DOCTYPE html>
<html lang="tr">

<head>
  <meta charset="UTF-8" />
  <title>YÃ¶netici Paneli</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/static/css/manager.css" />
</head>

<body>
  <!-- ===== YAN MENÃœ ===== -->
  <aside class="sidebar">
    <div class="brand">
      <div class="logo">ğŸ¢</div>
      <div class="brand-text">
        <strong>BinaYÃ¶netim</strong>
        <span>YÃ¶netici Paneli</span>
      </div>
    </div>

    <div class="sidebar-user-profile">
      <div class="sidebar-user-info">
        <div class="avatar small">YM</div>
        <div class="info-text">
          <strong id="mobileSidebarName">YÃ¶netici</strong>
          <small id="mobileSidebarMail">yonetici@site.com</small>
        </div>
      </div>
      <button id="mobileLogoutBtn" class="sidebar-logout">Ã‡Ä±kÄ±ÅŸ Yap</button>
    </div>

    <nav class="menu">
      <button class="menu-item active" data-view="dashboard">ğŸ“Š GÃ¶sterge Paneli</button>
      <button class="menu-item" data-view="approvals">âœ… Ãœye OnaylarÄ±</button>
      <button class="menu-item" data-view="members">ğŸ‘¥ Ãœyeler</button>
      <button class="menu-item" data-view="finances">ğŸ’µ Gelir & Giderler</button>
      <button class="menu-item" data-view="fees">ğŸ§¾ Aidat Takibi</button>
      <button class="menu-item" data-view="announcements">ğŸ“£ Duyurular</button>
      <button class="menu-item" data-view="messages">ğŸ’¬ Mesajlar</button>
      <button class="menu-item" data-view="reports">ğŸ“‘ Raporlar</button>
    </nav>
  </aside>

  <!-- ===== SAYFA ===== -->
  <main class="page">
    <header class="topbar">
      <button id="menuToggle" class="menu-toggle">
        â˜°
      </button>

      <div class="building-badge" id="buildingBadge">Bina</div>
      <div class="spacer"></div>

      <div id="sidebarOverlay" class="sidebar-overlay"></div>

      <div class="user">
        <div class="name-mail">
          <div class="name" id="managerNameTop">YÃ¶netici</div>
          <div class="mail" id="managerMailTop"></div>
        </div>
        <div class="avatar" id="avatarTop">YM</div>
        <button id="logout" class="ghost">Ã‡Ä±kÄ±ÅŸ Yap</button>
      </div>
    </header>

    <!-- ===== GÃ–STERGE PANELÄ° ===== -->
    <section id="view-dashboard" class="view show">
      <h1>YÃ¶netici GÃ¶sterge Paneli</h1>
      <p class="subtitle">Tekrar hoÅŸ geldiniz! BugÃ¼nkÃ¼ durum Ã¶zeti aÅŸaÄŸÄ±da.</p>

      <div class="cards">
        <div class="card">
          <div class="card-title">Toplam Gelir (Bu Ay)</div>
          <div class="card-value" id="cardIncome">â‚º0</div>
          <div class="trend up" id="cardIncomeTrend"></div>
        </div>
        <div class="card">
          <div class="card-title">Toplam Gider (Bu Ay)</div>
          <div class="card-value" id="cardExpenses">â‚º0</div>
          <div class="trend down" id="cardExpensesTrend"></div>
        </div>
        <div class="card">
          <div class="card-title">Net Gelir</div>
          <div class="card-value" id="cardNet">â‚º0</div>
          <div class="trend up" id="cardNetTrend"></div>
        </div>
        <div class="card">
          <div class="card-title">Bekleyen Onaylar</div>
          <div class="card-value" id="cardPending">0</div>
          <a class="link" data-view-link="approvals">Yeni kayÄ±tlar â†’</a>
        </div>
      </div>

      <div class="grid-2">
        <div class="panel">
          <div class="panel-head">
            <h3>Son Ã–demeler</h3>
          </div>
          <div class="list" id="recentPayments"></div>
        </div>
        <div class="panel">
          <div class="panel-head">
            <h3>Son Duyurular</h3>
            <button class="ghost small" data-view-link="announcements">TÃ¼mÃ¼nÃ¼ GÃ¶r</button>
          </div>
          <div class="list" id="recentAnnouncements"></div>
        </div>
      </div>
    </section>

    <!-- ===== ÃœYE ONAYLARI ===== -->
    <section id="view-approvals" class="view">
      <h1>Ãœye OnaylarÄ±</h1>
      <p class="subtitle">Bekleyen kayÄ±tlarÄ± onaylayÄ±n veya reddedin.</p>
      <div id="approvalsList" class="table"></div>
    </section>

    <!-- ===== ÃœYELER ===== -->
    <section id="view-members" class="view">
      <h1>Ãœyeler</h1>
      <p class="subtitle">Binadaki tÃ¼m Ã¼yeleri gÃ¶rÃ¼ntÃ¼leyin ve detaylarÄ±nÄ± inceleyin.</p>
      <div class="grid-2">
        <div class="panel">
          <div class="panel-head">
            <h3>Ãœye Listesi</h3>
          </div>
          <div id="membersList" class="list"></div>
        </div>
        <div class="panel">
          <div class="panel-head">
            <h3>Ãœye DetaylarÄ±</h3>
          </div>
          <div id="memberDetail" class="detail-box">
            <p class="empty">Bir Ã¼ye seÃ§in.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== GELÄ°R & GÄ°DERLER ===== -->
    <section id="view-finances" class="view">
      <h1>Gelir & Giderler</h1>
      <p class="subtitle">TÃ¼m mali iÅŸlemleri yÃ¶netin.</p>

      <!-- ===== Ã–ZET KARTLAR ===== -->
      <div class="cards finance-cards">
        <div class="card income-card">
          <div class="card-title">Toplam Gelir</div>
          <div class="card-value" id="totalIncome">â‚º0</div>
        </div>
        <div class="card expense-card">
          <div class="card-title">Toplam Gider</div>
          <div class="card-value" id="totalExpenses">â‚º0</div>
        </div>
        <div class="card balance-card">
          <div class="card-title">Net Bakiye</div>
          <div class="card-value" id="netBalance">â‚º0</div>
        </div>
      </div>

      <!-- ===== FORM ===== -->
      <div class="transaction-form-box">
        <h3>Yeni Ä°ÅŸlem Ekle</h3>
        <form id="transactionForm" class="transaction-form" onsubmit="return false;">
          <select id="type" required>
            <option value="income">Gelir</option>
            <option value="expense">Gider</option>
          </select>
          <input type="text" id="category" placeholder="Kategori" required />
          <input type="text" id="description" placeholder="AÃ§Ä±klama" required />
          <input type="number" id="amount" step="0.01" placeholder="Tutar" required />
          <label class="check">
            <input type="checkbox" id="visibleToResidents" checked />
            Sakinlere GÃ¶ster
          </label>
          <button type="button" id="addTransactionBtn">+ Ekle</button>
        </form>

      </div>

      <!-- ===== Ä°ÅLEM TABLOSU ===== -->
      <div class="panel transactions-panel">
        <div class="panel-head">
          <h3>TÃ¼m Ä°ÅŸlemler</h3>
        </div>

        <table id="transactionsTable">
          <thead>
            <tr>
              <th>Tarih</th>
              <th>TÃ¼r</th>
              <th>Kategori</th>
              <th>AÃ§Ä±klama</th>
              <th>Tutar</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- ===== AÄ°DAT / DUYURULAR / RAPORLAR ===== -->
    <!-- ===== AÄ°DAT TAKÄ°BÄ° ===== -->
    <!-- ===== AÄ°DAT TAKÄ°BÄ° ===== -->
    <section id="view-fees" class="view">
      <h1>ğŸ§¾ Aidat Takibi</h1>
      <p class="subtitle">AidatlarÄ± oluÅŸtur, kullanÄ±cÄ±larÄ±n Ã¶deme bildirimlerini onayla.</p>

      <!-- ===== AÄ°DAT OLUÅTURMA ===== -->
      <div class="panel">
        <div class="panel-head">
          <h3>Yeni Aidat / Ãœcret OluÅŸtur (TÃ¼m Sakinlere)</h3>
        </div>

        <form id="dueCreateForm" class="due-form" onsubmit="return false;">

          <div class="due-row">
            <label>Ay</label>
            <input type="month" id="dueMonth" required />
          </div>

          <div class="due-row">
            <label>Tutar (â‚º)</label>
            <input type="number" id="dueAmount" step="0.01" placeholder="0.00" required />
          </div>

          <div class="due-row">
            <label>Son Tarih</label>
            <input type="date" id="dueDate" required />
          </div>

          <div class="due-row">
            <label>Ãœcret TÃ¼rÃ¼</label>
            <select id="dueType">
              <option value="aidat">Aidat</option>
              <option value="bakim">BakÄ±m Ãœcreti</option>
              <option value="onarim">OnarÄ±m</option>
              <option value="elektrik">Ortak Alan Elektrik</option>
              <option value="ozel">Ã–zel Ã–deme</option>
            </select>
          </div>

          <button type="button" id="createDueBtn" class="btn-due">ğŸ§¾ Aidat / Ãœcret OluÅŸtur</button>
        </form>

        <small class="muted">
          SeÃ§ilen ay iÃ§in binadaki tÃ¼m sakinlere toplu Ã¶deme kaydÄ± aÃ§Ä±lÄ±r.
        </small>
      </div>

      <!-- ===== AÄ°DAT LÄ°STESÄ° ===== -->
      <div class="panel">
        <div class="panel-head">
          <h3>TÃ¼m Aidatlar & Ãœcretler</h3>
        </div>

        <table class="styled-table" id="duesTable">
          <thead>
            <tr>
              <th>KullanÄ±cÄ±</th>
              <th>Ay</th>
              <th>Tutar</th>
              <th>TÃ¼r</th>
              <th>Son Tarih</th>
              <th>Durum</th>
              <th>Ã–deme Tarihi</th>
            </tr>
          </thead>
          <tbody id="duesBody">
            <tr>
              <td colspan="7">YÃ¼kleniyor...</td>
            </tr>
          </tbody>
        </table>
      </div>


      <!-- ===== Ã–DEME BÄ°LDÄ°RÄ°MLERÄ° ===== -->
      <div class="panel">
        <div class="panel-head">
          <h3>Ã–deme Bildirimleri</h3>
        </div>

        <table class="styled-table" id="paymentNotificationsTable">
          <thead>
            <tr>
              <th>KullanÄ±cÄ±</th>
              <th>Ay</th>
              <th>Tutar</th>
              <th>Dekont</th>
              <th>Durum</th>
              <th>Ä°ÅŸlem</th>
            </tr>
          </thead>
          <tbody id="paymentNotificationsBody">
            <tr>
              <td colspan="6">YÃ¼kleniyor...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>


    <section id="view-announcements" class="view">
      <h1>Duyurular</h1>
      <p class="subtitle">Yeni duyuru ekleyin veya mevcut duyurularÄ± gÃ¶rÃ¼ntÃ¼leyin.</p>

      <div class="panel">
        <h3>Yeni Duyuru</h3>
        <form id="announcementForm" onsubmit="return false;">
          <input type="text" id="annTitle" placeholder="BaÅŸlÄ±k" required />
          <textarea id="annMessage" placeholder="Duyuru metni" required></textarea>
          <select id="annLevel" required>
            <option value="high">YÃ¼ksek</option>
            <option value="medium">Orta</option>
            <option value="low">DÃ¼ÅŸÃ¼k</option>
          </select>
          <button id="addAnnouncementBtn" type="button">+ Ekle</button>
        </form>
      </div>

      <!-- DUYURU SEKMELERÄ° -->
      <div class="msg-tabs" style="justify-content: flex-start; margin-bottom: 20px;">
        <button id="annTabActive" class="tab-btn active">Aktif Duyurular</button>
        <button id="annTabArchived" class="tab-btn">ArÅŸiv</button>
      </div>

      <div class="panel">
        <h3 id="annListTitle">Aktif Duyurular</h3>
        <div id="announcementsList" class="list"></div>
      </div>
    </section>

    <section id="view-messages" class="view">
      <h1>ğŸ’¬ Mesajlar</h1>
      <p class="subtitle">Sakinlerden gelen mesajlarÄ± yÃ¶netin.</p>

      <div class="panel" id="messagesList" style="min-height: 400px;">
        <!-- JS ile doldurulacak -->
      </div>
    </section>

    <section id="view-reports" class="view">

      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <div>
          <h1 style="margin:0;">ğŸ“‘ Raporlar</h1>
          <p class="subtitle" style="margin:0;">TÃ¼m finansal ve yÃ¶netim raporlarÄ±nÄ± buradan gÃ¶rÃ¼ntÃ¼leyin.</p>
        </div>

        <!-- TARÄ°H FÄ°LTRESÄ° -->
        <div class="filter-box"
          style="display:flex; gap:10px; align-items:center; background:#1e293b; padding:10px; border-radius:8px; border:1px solid #334155;">
          <input type="date" id="filterStartDate"
            style="padding:6px; border-radius:4px; border:1px solid #475569; background:#0f172a; color:white;">
          <span style="color:white;">-</span>
          <input type="date" id="filterEndDate"
            style="padding:6px; border-radius:4px; border:1px solid #475569; background:#0f172a; color:white;">
          <button id="filterBtn"
            style="padding:6px 12px; background:#3b82f6; color:white; border:none; border-radius:4px; cursor:pointer;">Filtrele</button>
        </div>
      </div>

      <!-- === Ã–ZET KARTLAR === -->
      <div class="cards finance-cards">
        <div class="card income-card">
          <div class="card-title">Toplam Gelir</div>
          <div class="card-value" id="reportTotalIncome">â‚º0</div>
        </div>
        <div class="card expense-card">
          <div class="card-title">Toplam Gider</div>
          <div class="card-value" id="reportTotalExpense">â‚º0</div>
        </div>
        <div class="card balance-card">
          <div class="card-title">Net Bakiye</div>
          <div class="card-value" id="reportBalance">â‚º0</div>
        </div>

        <!-- YENÄ° KARTLAR -->
        <div class="card">
          <div class="card-title">Tahsilat OranÄ± (Bu Ay)</div>
          <div class="card-value" id="reportCollectionRate">%0</div>
        </div>
        <div class="card" style="border-left: 4px solid #F1C40F;">
          <div class="card-title">Toplam Ã–denmemiÅŸ BorÃ§</div>
          <div class="card-value" id="reportTotalDebt">â‚º0</div>
        </div>
      </div>

      <!-- === GRAFÄ°KLER === -->
      <div class="grid-2">
        <div class="panel">
          <div class="panel-head">
            <h3>AylÄ±k Gelir-Gider GrafiÄŸi</h3>
          </div>
          <canvas id="monthlyChart"></canvas>
        </div>

        <div class="panel">
          <div class="panel-head">
            <h3>Kategori BazlÄ± DaÄŸÄ±lÄ±m</h3>
          </div>
          <canvas id="categoryChart"></canvas>
        </div>
      </div>

      <!-- === DETAY TABLOSU === -->
      <div class="panel transactions-panel">
        <div class="panel-head">
          <h3>DetaylÄ± Ä°ÅŸlem Listesi</h3>
          <div class="export-buttons">
            <button id="exportCSV">CSV Ä°ndir</button>
            <button id="exportPDF">PDF Ä°ndir</button>
          </div>
        </div>
        <table id="reportTable">
          <thead>
            <tr>
              <th>Tarih</th>
              <th>TÃ¼r</th>
              <th>Kategori</th>
              <th>AÃ§Ä±klama</th>
              <th>Tutar</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- Grafik kÃ¼tÃ¼phanesi -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- PDF KÃ¼tÃ¼phanesi -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="/static/js/raporlar.js"></script>

    <!-- PROFIL DÃœZENLEME MODALI (MANAGER) -->
    <div id="profileModal" class="modal hidden">
      <div class="modal-card">
        <h3>YÃ¶netici Profilini DÃ¼zenle</h3>
        <p class="modal-subtitle">Bilgilerinizi gÃ¼ncelleyebilirsiniz.</p>

        <div class="form-group">
          <label>Ad</label>
          <input type="text" id="editName" />
        </div>
        <div class="form-group">
          <label>Soyad</label>
          <input type="text" id="editSurname" />
        </div>
        <div class="form-group">
          <label>E-posta</label>
          <input type="email" id="editEmail" />
        </div>
        <div class="form-group">
          <label>Telefon</label>
          <input type="tel" id="editPhone" />
        </div>

        <div class="modal-actions">
          <button id="saveProfileBtn">Kaydet</button>
          <button id="closeProfileBtn" class="ghost">Ä°ptal</button>
        </div>
      </div>
    </div>

  </main>

  <script src="/static/js/dashboard_manager.js"></script>
</body>

</html>